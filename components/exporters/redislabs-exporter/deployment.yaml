---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: hosted-redislabs-exporter
  namespace: oe-redis-exporter-hosted
spec:
  replicas: 1
  selector:
    matchLabels:
      app: hosted-redislabs-exporter
  template:
    metadata:
      labels:
        app: hosted-redislabs-exporter
        release: kube-prometheus-stack
        monitoring: prometheus
        sc_system: ${sc_system}
        sc_domain: ${sc_domain}
        sc_component: ${sc_system}-redislabs_exporter
        sc_env: ${sc_env}
        sc_region: ${sc_region}
        sc_provider: ${sc_provider}
        sc_createdby: ${sc_createdby}
        sc_type: ${sc_type}
        sc_owner: ${sc_owner}
    spec:
        containers:
          - name: hosted-redislabs-exporter
            image: contenthub.azurecr.io/monitoring/hosted-redislabs-exporter:1.0.3
            env:
            - name: API_URI
              value: "https://api.redislabs.com/v1"
            - name: EXPORTER_METRICS_PORT
              value: "8070"
            envFrom:
            - secretRef:
                name: oe-redis-exporter-hosted-credentials
            imagePullPolicy: Always
            resources:
              requests:
                memory: "0.25Gi"
                cpu: "0.25"
              limits:
                memory: "0.5Gi"
                cpu: "0.5"

